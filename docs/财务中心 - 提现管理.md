# 财务中心 - 提现管理 PRD

## 1. 功能概述

提现管理是财务中心的核心模块，用于管理B端用户（大B/小B）的提现申请、审核、打款等全流程，确保资金安全和合规性。

## 2. 功能模块

### 2.1 提现申请审核

**页面位置：** 财务中心 → 提现管理 → 提现申请审核

**功能概述：**
管理员审核B端用户（大B/小B）的提现申请，包括查看申请信息、审核发票、批准或驳回申请等操作。

**列表显示字段：**
- 提现单号、用户ID、用户名称、用户类型（大B客户/小B客户）
- 业务模式（SaaS/MCP/推广联盟）
- 提现金额、可用余额、申请时间
- 审核状态（待审核/审核中/已通过/已拒绝）
- 审核时间、审核人
- 提现账户类型（银行账户/支付宝/微信）
- 操作（查看详情/审核/查看余额明细）

**筛选条件：**
- 审核状态：待审核/审核中/已通过/已拒绝/全部
- 用户类型：大B客户/小B客户/全部
- 业务模式：SaaS/MCP/推广联盟/全部
- 用户名称：文本输入筛选
- 提现单号：文本输入筛选
- 申请时间范围：开始日期、结束日期
- 提现金额范围：最小金额、最大金额

**统计信息：**
- 待审核提现总金额、待审核提现笔数
- 今日审核通过金额、今日审核通过笔数
- 今日审核拒绝金额、今日审核拒绝笔数
- 本月累计提现金额、本月累计提现笔数

**详情页面：**
- **提现基本信息**：
  - 提现单号、用户ID、用户名称、用户类型（大B客户/小B客户）、业务模式
  - 提现金额、可用余额、申请时间、审核状态、审核时间、审核人
  - 提现账户类型、提现账户、提现用户名、提现人电话
  - 备注（申请人填写）
- **发票信息**（仅企业用户）：
  - 发票类型（增值税专用发票/增值税普通发票）
  - 发票代码、发票号码、开票日期、发票金额
  - 发票状态（已上传/待上传/审核通过/审核拒绝）
  - 发票图片/文件（支持查看和下载）
  - 发票审核意见（如有）
- **余额明细**：
  - 可用余额、冻结余额、累计收益、累计提现金额
  - 余额明细列表（收入记录、支出记录、冻结记录）
- **操作历史记录**：
  - 操作时间、操作人、操作类型（申请/审核通过/审核拒绝/打款/失败）、操作备注

**操作功能：**
- **审核通过**：
  - 审核条件：发票信息完整且合规（企业用户需上传发票）、提现金额不超过可用余额
  - 审核通过后，系统自动发起打款流程
  - 状态更新为"审核通过"，进入打款流程
- **审核拒绝**：
  - 需填写拒绝原因（如：发票信息错误、金额不符、账户信息错误等）
  - 状态更新为"已拒绝"
  - 通知申请人（邮件/站内消息）
- **查看详情**：查看完整的提现申请信息
- **查看余额明细**：查看用户的账户余额和明细记录
- **批量操作**：
  - 批量审核通过（需选择多个待审核的提现申请）
  - 批量审核拒绝（需填写拒绝原因）
  - 批量导出（导出选中的提现申请记录）

**审核流程：**
1. B端用户发起提现申请（企业用户需上传发票）
2. 系统校验提现金额是否超过可用余额
3. 财务人员审核提现申请（重点审核发票信息和金额）
4. 审核通过后，系统自动发起打款流程
5. 打款成功后，状态更新为"提现成功"，扣减可用余额
6. 打款失败后，状态更新为"提现失败"，通知财务人员和申请人

### 2.2 提现记录管理

**页面位置：** 财务中心 → 提现管理 → 提现记录管理

**功能概述：**
查看和管理所有提现记录，包括提现申请、审核、打款等全流程记录，支持查询、筛选、导出等操作。

**列表显示字段：**
- 提现单号、用户ID、用户名称、用户类型（大B客户/小B客户）
- 业务模式（SaaS/MCP/推广联盟）
- 提现金额、提现状态、申请时间、转账汇款时间（到账时间）
- 流水号（打款流水号）、提现账户、提现用户名
- 提现人电话、审核人、操作（查看详情）

**筛选条件：**
- 提现状态：待审核/审核中/审核通过/已拒绝/处理中/提现成功/提现失败/提现关闭/全部
- 用户类型：大B客户/小B客户/全部
- 业务模式：SaaS/MCP/推广联盟/全部
- 用户名称：文本输入筛选
- 提现单号：文本输入筛选
- 流水号：文本输入筛选
- 申请时间范围：开始日期、结束日期
- 转账汇款时间范围：开始日期、结束日期
- 提现金额范围：最小金额、最大金额

**统计信息：**
- 提现总金额、提现总笔数
- 提现成功金额、提现成功笔数
- 提现失败金额、提现失败笔数
- 今日提现金额、今日提现笔数
- 本月累计提现金额、本月累计提现笔数

**详情页面：**
- **提现基本信息**：
  - 提现单号、用户ID、用户名称、用户类型（大B客户/小B客户）、业务模式
  - 提现金额、提现状态、申请时间、转账汇款时间（到账时间）
  - 流水号（打款流水号）、提现账户类型、提现账户、提现用户名、提现人电话
  - 审核人、审核时间、审核意见
  - 备注（申请人填写）
- **发票信息**（仅企业用户）：
  - 发票类型、发票代码、发票号码、开票日期、发票金额
  - 发票状态、发票图片/文件（支持查看和下载）
  - 发票审核意见（如有）
- **打款信息**（如已打款）：
  - 打款时间、打款金额、打款账户、收款账户
  - 打款状态、打款凭证（如有）
  - 打款失败原因（如打款失败）
- **操作历史记录**：
  - 操作时间、操作人、操作类型（申请/审核通过/审核拒绝/打款/失败/关闭）、操作备注

**操作功能：**
- **查看详情**：查看完整的提现记录信息
- **重新发起**（如提现失败）：
  - 仅支持状态为"提现失败"的记录
  - 重新发起打款流程
  - 状态更新为"处理中"
- **关闭提现**（如申请人取消）：
  - 仅支持状态为"待审核"或"审核中"的记录
  - 关闭提现申请，状态更新为"提现关闭"
  - 通知申请人
- **批量操作**：
  - 批量重新发起（需选择多个提现失败的记录）
  - 批量关闭（需选择多个待审核或审核中的记录）
  - 批量导出（导出筛选后的提现记录，Excel格式）

**提现状态说明：**
- **待审核**：用户已提交提现申请，等待财务审核
- **审核中**：财务人员正在审核中
- **审核通过**：审核通过，等待打款
- **已拒绝**：审核被拒绝，需填写拒绝原因
- **处理中**：系统正在处理打款流程
- **提现成功**：打款成功，资金已到账
- **提现失败**：打款失败，需重新发起或人工处理
- **提现关闭**：提现申请被关闭（申请人取消或管理员关闭）

## 3. 业务规则

### 3.1 提现申请规则
- 提现金额不能超过可用余额
- 企业用户必须上传发票（发票金额需等于或大于提现金额）
- 个人用户（旅行代理/网络博主）不需要上传发票
- 提现账户信息必须完整且正确
- 每日提现限额：根据用户等级和风控规则设置
- 每月提现限额：根据用户等级和风控规则设置

### 3.2 审核规则
- 财务人员审核重点：发票信息（企业用户）、提现金额、账户信息
- 发票审核：建议对接发票验真API，验证发票真实性
- 审核时效：建议在1-3个工作日内完成审核
- 审核拒绝：需填写详细的拒绝原因，通知申请人

### 3.3 打款规则
- 审核通过后，系统自动发起打款流程
- 打款方式：银行企业付款API（公对公转账）
- 打款时间：审核通过后1-3个工作日内完成打款
- 打款成功后，系统自动扣减可用余额
- 打款失败后，系统通知财务人员和申请人，支持重新发起

### 3.4 余额扣减规则
- 提现申请时：不扣减余额，状态为"待审核"
- 审核通过后：冻结提现金额，状态为"审核通过"或"处理中"
- 打款成功后：扣减可用余额，状态为"提现成功"
- 审核拒绝后：不扣减余额，状态为"已拒绝"
- 提现关闭后：不扣减余额，状态为"提现关闭"

## 4. 数据字段设计

### 4.1 提现申请记录
- 提现单号（唯一标识）
- 用户ID、用户名称、用户类型（大B客户/小B客户）
- 业务模式（SaaS/MCP/推广联盟）
- 提现金额、可用余额
- 提现账户类型（银行账户/支付宝/微信）
- 提现账户、提现用户名、提现人电话
- 申请时间、审核状态、审核时间、审核人
- 审核意见（如有）
- 备注（申请人填写）
- 发票信息（仅企业用户）：
  - 发票类型、发票代码、发票号码、开票日期、发票金额
  - 发票状态、发票文件路径、发票审核意见

### 4.2 提现记录
- 提现单号（唯一标识）
- 用户ID、用户名称、用户类型（大B客户/小B客户）
- 业务模式（SaaS/MCP/推广联盟）
- 提现金额、提现状态
- 申请时间、转账汇款时间（到账时间）
- 流水号（打款流水号）
- 提现账户类型、提现账户、提现用户名、提现人电话
- 审核人、审核时间、审核意见
- 打款信息（如已打款）：
  - 打款时间、打款金额、打款账户、收款账户
  - 打款状态、打款凭证、打款失败原因
- 备注（申请人填写）
- 发票信息（仅企业用户）
- 操作历史记录

## 5. 交互流程

### 5.1 提现申请流程
1. B端用户登录后台，进入提现管理页面
2. 查看可用余额，填写提现金额（不超过可用余额）
3. 填写提现账户信息（账户类型、账户、用户名、电话）
4. 企业用户上传发票（发票金额需等于或大于提现金额）
5. 提交提现申请，状态为"待审核"
6. 系统通知财务人员有新提现申请

### 5.2 提现审核流程
1. 财务人员查看待审核的提现申请列表
2. 点击"查看详情"，查看完整的提现申请信息
3. 审核发票信息（企业用户）：验证发票真实性、发票金额、发票类型
4. 审核提现金额：确认不超过可用余额
5. 审核账户信息：确认账户信息完整且正确
6. 审核通过：点击"审核通过"，系统自动发起打款流程，状态更新为"审核通过"
7. 审核拒绝：点击"审核拒绝"，填写拒绝原因，状态更新为"已拒绝"，通知申请人

### 5.3 打款流程
1. 审核通过后，系统自动发起打款流程
2. 调用银行企业付款API，执行公对公转账
3. 打款成功：状态更新为"提现成功"，扣减可用余额，通知申请人
4. 打款失败：状态更新为"提现失败"，通知财务人员和申请人，支持重新发起

### 5.4 重新发起流程
1. 提现失败后，财务人员或申请人可以重新发起打款
2. 点击"重新发起"，系统重新调用银行企业付款API
3. 打款成功：状态更新为"提现成功"，扣减可用余额
4. 打款失败：状态更新为"提现失败"，需人工处理

## 6. 权限和通知

### 6.1 权限控制
- **查看提现申请列表**：财务人员、财务主管
- **审核提现申请**：财务人员、财务主管
- **查看提现记录**：财务人员、财务主管、管理员
- **重新发起打款**：财务人员、财务主管
- **关闭提现**：财务人员、财务主管、管理员
- **导出记录**：财务人员、财务主管、管理员

### 6.2 通知机制
- **提现申请通知**：
  - 触发条件：用户提交提现申请
  - 通知方式：站内消息
  - 通知对象：财务人员
  - 通知内容：用户名称、提现金额、申请时间、查看链接
- **审核结果通知**：
  - 触发条件：审核通过或审核拒绝
  - 通知方式：邮件 + 站内消息
  - 通知对象：申请人
  - 通知内容：审核结果、审核意见、查看链接
- **打款成功通知**：
  - 触发条件：打款成功
  - 通知方式：邮件 + 站内消息
  - 通知对象：申请人
  - 通知内容：打款金额、到账时间、查看链接
- **打款失败通知**：
  - 触发条件：打款失败
  - 通知方式：邮件 + 站内消息
  - 通知对象：财务人员、申请人
  - 通知内容：打款失败原因、查看链接

## 7. 页面设计

### 7.1 提现申请审核列表页

#### 7.1.1 页面结构

**面包屑导航**：
```
财务中心 > 提现管理 > 提现申请审核
```

**页面组成**：
1. 统计信息卡片
2. 搜索和筛选区域
3. 提现申请列表表格
4. 批量操作工具栏
5. 分页组件

#### 7.1.2 统计信息

展示当前筛选条件下的汇总数据：
- **待审核提现总金额**：状态为"待审核"的提现金额汇总
- **待审核提现笔数**：状态为"待审核"的提现申请数量
- **今日审核通过金额**：当天审核通过的提现金额汇总
- **今日审核通过笔数**：当天审核通过的提现申请数量
- **今日审核拒绝金额**：当天审核拒绝的提现金额汇总
- **今日审核拒绝笔数**：当天审核拒绝的提现申请数量
- **本月累计提现金额**：当月所有提现金额汇总
- **本月累计提现笔数**：当月所有提现申请数量

#### 7.1.3 搜索和筛选

**搜索框**：
- 支持按提现单号、用户名称搜索
- 实时搜索，输入即过滤

**筛选条件**：
- **审核状态**：全部/待审核/审核中/已通过/已拒绝
- **用户类型**：全部/大B客户/小B客户
- **业务模式**：全部/SaaS/MCP/推广联盟
- **申请时间**：开始日期 - 结束日期
- **提现金额区间**：最小金额 - 最大金额

#### 7.1.4 列表字段

| 字段名称 | 说明 | 宽度 | 对齐 |
|---------|------|------|------|
| 提现单号 | 提现申请唯一标识 | 150px | 左 |
| 用户ID | 用户唯一标识 | 120px | 左 |
| 用户名称 | 申请人名称 | 150px | 左 |
| 用户类型 | 大B客户/小B客户 | 100px | 左 |
| 业务模式 | SaaS/MCP/推广联盟 | 120px | 左 |
| 提现金额 | 申请提现金额 | 120px | 右 |
| 可用余额 | 当前可用余额 | 120px | 右 |
| 申请时间 | 提交申请时间 | 160px | 左 |
| 审核状态 | 待审核/审核中/已通过/已拒绝 | 100px | 中 |
| 审核时间 | 完成审核时间 | 160px | 左 |
| 审核人 | 审核操作人 | 100px | 左 |
| 提现账户类型 | 银行账户/支付宝/微信 | 120px | 左 |
| 操作 | 查看详情/审核/查看余额 | 200px | 中 |

#### 7.1.5 审核状态

- **待审核**：黄色标签，申请已提交等待审核
- **审核中**：蓝色标签，财务人员正在审核
- **已通过**：绿色标签，审核通过等待打款
- **已拒绝**：红色标签，审核未通过

#### 7.1.6 操作按钮

**单条操作**：
- **查看详情**：查看提现申请完整信息
- **审核**（待审核/审核中状态）：审核通过或拒绝
- **查看余额明细**：查看用户账户余额和流水

**批量操作**：
- **批量审核通过**：批量通过选中的待审核申请
- **批量审核拒绝**：批量拒绝选中的待审核申请
- **批量导出**：导出选中申请的数据

---

### 7.2 提现申请审核详情页

#### 7.2.1 页面结构

**面包屑导航**：
```
财务中心 > 提现管理 > 提现申请审核 > 详情
```

**页面组成**：
1. 提现基本信息卡片
2. 用户信息卡片
3. 账户信息卡片
4. 发票信息卡片（仅企业用户）
5. 余额明细卡片
6. 操作历史记录
7. 操作按钮区域

#### 7.2.2 提现基本信息

**字段列表**：
- **提现单号**：唯一标识
- **审核状态**：状态Badge（待审核/审核中/已通过/已拒绝）
- **提现金额**：申请提现金额
- **可用余额**：当前可用余额
- **申请时间**：提交申请时间
- **审核时间**：完成审核时间（如有）
- **审核人**：审核操作人（如有）
- **审核意见**：审核备注（如有）
- **申请备注**：申请人填写的备注

#### 7.2.3 用户信息

**字段列表**：
- **用户ID**：用户唯一标识
- **用户名称**：申请人名称
- **用户类型**：大B客户/小B客户
- **业务模式**：SaaS/MCP/推广联盟
- **联系电话**：用户联系方式

#### 7.2.4 账户信息

**字段列表**：
- **提现账户类型**：银行账户/支付宝/微信
- **提现账户**：收款账号
- **提现用户名**：收款户名
- **提现人电话**：收款人联系电话

#### 7.2.5 发票信息（仅企业用户）

**字段列表**：
- **发票类型**：增值税专用发票/增值税普通发票
- **发票代码**：发票代码
- **发票号码**：发票号码
- **开票日期**：发票开具日期
- **发票金额**：发票金额
- **发票状态**：已上传/待上传/审核通过/审核拒绝
- **发票文件**：支持查看和下载发票图片/PDF
- **发票审核意见**：审核备注（如有）

**发票验证**：
- 支持对接发票验真API
- 自动验证发票真实性
- 显示验证结果

#### 7.2.6 余额明细

**字段列表**：
- **可用余额**：当前可用余额
- **冻结余额**：冻结中的金额
- **累计收益**：历史累计收益
- **累计提现金额**：历史累计提现金额

**余额明细列表**：
- 时间、类型（收入/支出/冻结）、金额、余额、说明

#### 7.2.7 操作历史记录

记录提现申请的所有操作历史：
- 操作时间
- 操作人
- 操作类型（申请/审核通过/审核拒绝/打款/失败）
- 操作说明

#### 7.2.8 操作按钮

根据审核状态显示不同操作：

**待审核/审核中状态**：
- **审核通过**：审核通过，自动发起打款流程
- **审核拒绝**：审核拒绝，需填写拒绝原因
- **查看余额明细**：查看用户账户详情

**已通过/已拒绝状态**：
- **查看余额明细**：查看用户账户详情
- **返回列表**：返回提现申请列表

---

### 7.3 提现记录管理列表页

#### 7.3.1 页面结构

**面包屑导航**：
```
财务中心 > 提现管理 > 提现记录管理
```

**页面组成**：
1. 统计信息卡片
2. 搜索和筛选区域
3. 提现记录列表表格
4. 批量操作工具栏
5. 分页组件

#### 7.3.2 统计信息

展示当前筛选条件下的汇总数据：
- **提现总金额**：所有记录的提现金额汇总
- **提现总笔数**：所有提现记录数量
- **提现成功金额**：状态为"提现成功"的金额汇总
- **提现成功笔数**：状态为"提现成功"的记录数量
- **提现失败金额**：状态为"提现失败"的金额汇总
- **提现失败笔数**：状态为"提现失败"的记录数量
- **今日提现金额**：当天提现金额汇总
- **今日提现笔数**：当天提现记录数量
- **本月累计提现金额**：当月提现金额汇总
- **本月累计提现笔数**：当月提现记录数量

#### 7.3.3 搜索和筛选

**搜索框**：
- 支持按提现单号、用户名称、流水号搜索
- 实时搜索，输入即过滤

**筛选条件**：
- **提现状态**：全部/待审核/审核中/审核通过/已拒绝/处理中/提现成功/提现失败/提现关闭
- **用户类型**：全部/大B客户/小B客户
- **业务模式**：全部/SaaS/MCP/推广联盟
- **申请时间**：开始日期 - 结束日期
- **转账汇款时间**：开始日期 - 结束日期
- **提现金额区间**：最小金额 - 最大金额

#### 7.3.4 列表字段

| 字段名称 | 说明 | 宽度 | 对齐 |
|---------|------|------|------|
| 提现单号 | 提现记录唯一标识 | 150px | 左 |
| 用户ID | 用户唯一标识 | 120px | 左 |
| 用户名称 | 申请人名称 | 150px | 左 |
| 用户类型 | 大B客户/小B客户 | 100px | 左 |
| 业务模式 | SaaS/MCP/推广联盟 | 120px | 左 |
| 提现金额 | 提现金额 | 120px | 右 |
| 提现状态 | 8种状态 | 120px | 中 |
| 申请时间 | 提交申请时间 | 160px | 左 |
| 转账汇款时间 | 到账时间 | 160px | 左 |
| 流水号 | 打款流水号 | 150px | 左 |
| 提现账户 | 收款账号 | 150px | 左 |
| 提现用户名 | 收款户名 | 120px | 左 |
| 审核人 | 审核操作人 | 100px | 左 |
| 操作 | 查看详情/重新发起/关闭 | 200px | 中 |

#### 7.3.5 提现状态

- **待审核**：黄色标签，申请已提交等待审核
- **审核中**：蓝色标签，财务人员正在审核
- **审核通过**：绿色标签，审核通过等待打款
- **已拒绝**：红色标签，审核未通过
- **处理中**：蓝色标签，系统正在处理打款
- **提现成功**：绿色标签，打款成功资金已到账
- **提现失败**：红色标签，打款失败需重新发起
- **提现关闭**：灰色标签，提现申请已关闭

#### 7.3.6 操作按钮

**单条操作**：
- **查看详情**：查看提现记录完整信息
- **重新发起**（提现失败状态）：重新发起打款流程
- **关闭提现**（待审核/审核中状态）：关闭提现申请

**批量操作**：
- **批量重新发起**：批量重新发起选中的失败记录
- **批量关闭**：批量关闭选中的待审核/审核中记录
- **批量导出**：导出选中记录的数据

---

### 7.4 提现记录详情页

#### 7.4.1 页面结构

**面包屑导航**：
```
财务中心 > 提现管理 > 提现记录管理 > 详情
```

**页面组成**：
1. 提现基本信息卡片
2. 用户信息卡片
3. 账户信息卡片
4. 发票信息卡片（仅企业用户）
5. 打款信息卡片（如已打款）
6. 操作历史记录
7. 操作按钮区域

#### 7.4.2 提现基本信息

**字段列表**：
- **提现单号**：唯一标识
- **提现状态**：状态Badge
- **提现金额**：提现金额
- **申请时间**：提交申请时间
- **转账汇款时间**：到账时间（如有）
- **流水号**：打款流水号（如有）
- **审核人**：审核操作人（如有）
- **审核时间**：完成审核时间（如有）
- **审核意见**：审核备注（如有）
- **申请备注**：申请人填写的备注

#### 7.4.3 用户信息

**字段列表**：
- **用户ID**：用户唯一标识
- **用户名称**：申请人名称
- **用户类型**：大B客户/小B客户
- **业务模式**：SaaS/MCP/推广联盟
- **联系电话**：用户联系方式

#### 7.4.4 账户信息

**字段列表**：
- **提现账户类型**：银行账户/支付宝/微信
- **提现账户**：收款账号
- **提现用户名**：收款户名
- **提现人电话**：收款人联系电话

#### 7.4.5 发票信息（仅企业用户）

**字段列表**：
- **发票类型**：增值税专用发票/增值税普通发票
- **发票代码**：发票代码
- **发票号码**：发票号码
- **开票日期**：发票开具日期
- **发票金额**：发票金额
- **发票状态**：已上传/待上传/审核通过/审核拒绝
- **发票文件**：支持查看和下载发票图片/PDF
- **发票审核意见**：审核备注（如有）

#### 7.4.6 打款信息（如已打款）

**字段列表**：
- **打款时间**：实际打款时间
- **打款金额**：实际打款金额
- **打款账户**：付款账户
- **收款账户**：收款账户
- **打款状态**：打款成功/打款失败
- **打款凭证**：打款凭证文件（如有）
- **打款失败原因**：失败原因说明（如打款失败）

#### 7.4.7 操作历史记录

记录提现记录的所有操作历史：
- 操作时间
- 操作人
- 操作类型（申请/审核通过/审核拒绝/打款/失败/关闭）
- 操作说明

#### 7.4.8 操作按钮

根据提现状态显示不同操作：

**提现失败状态**：
- **重新发起**：重新发起打款流程
- **返回列表**：返回提现记录列表

**待审核/审核中状态**：
- **关闭提现**：关闭提现申请
- **返回列表**：返回提现记录列表

**其他状态**：
- **返回列表**：返回提现记录列表

---

## 8. 交互说明

### 8.1 审核流程

#### 8.1.1 单个审核

1. 点击"审核"按钮
2. 弹出审核对话框
3. 查看提现申请详细信息
4. 验证发票信息（企业用户）
5. 选择"审核通过"或"审核拒绝"
6. 审核拒绝时必须填写拒绝原因（至少10个字符）
7. 确认提交
8. 系统更新审核状态
9. 审核通过后自动发起打款流程
10. 发送通知给申请人

#### 8.1.2 批量审核

1. 勾选多个待审核申请
2. 点击"批量审核通过"或"批量审核拒绝"按钮
3. 弹出批量审核对话框
4. 批量拒绝时填写统一拒绝原因
5. 确认提交
6. 系统批量更新审核状态
7. 显示处理结果（成功/失败数量）

### 8.2 打款流程

#### 8.2.1 自动打款

1. 审核通过后，系统自动发起打款流程
2. 调用银行企业付款API
3. 执行公对公转账
4. 打款成功：
   - 更新状态为"提现成功"
   - 扣减可用余额
   - 记录打款流水号
   - 发送成功通知
5. 打款失败：
   - 更新状态为"提现失败"
   - 记录失败原因
   - 发送失败通知

#### 8.2.2 重新发起打款

1. 点击"重新发起"按钮
2. 弹出确认对话框
3. 确认重新发起
4. 系统重新调用打款API
5. 更新打款状态
6. 发送通知

### 8.3 关闭提现流程

1. 点击"关闭提现"按钮
2. 弹出确认对话框，填写关闭原因
3. 确认关闭
4. 系统执行：
   - 更新状态为"提现关闭"
   - 解冻冻结金额（如有）
   - 记录操作历史
5. 发送通知给申请人

---

## 9. 异常处理

### 9.1 审核异常

- **提现金额超过可用余额**：提示"提现金额超过可用余额，无法审核通过"
- **发票信息缺失**：提示"企业用户必须上传发票，请联系申请人补充"
- **发票验证失败**：提示"发票验证失败，请核实发票信息"
- **权限不足**：提示"您没有审核权限"
- **状态已变更**：提示"提现状态已更新，请刷新后重试"

### 9.2 打款异常

- **账户信息错误**：提示"收款账户信息错误，打款失败"
- **余额不足**：提示"平台账户余额不足，无法完成打款"
- **银行系统异常**：提示"银行系统异常，打款失败，请稍后重试"
- **重复打款**：提示"该提现已打款，请勿重复操作"

### 9.3 关闭异常

- **状态不允许关闭**：提示"当前状态不允许关闭提现"
- **已打款无法关闭**：提示"提现已打款，无法关闭"

---

## 10. 数据校验

### 10.1 审核校验

- 提现状态必须为"待审核"或"审核中"
- 企业用户必须上传发票
- 发票金额必须大于或等于提现金额
- 提现金额必须不超过可用余额
- 审核拒绝时拒绝原因必填，至少10个字符
- 审核人必须有审核权限

### 10.2 打款校验

- 提现状态必须为"审核通过"
- 收款账户信息必须完整
- 平台账户余额必须充足
- 打款金额必须等于提现金额

### 10.3 关闭校验

- 提现状态必须为"待审核"或"审核中"
- 关闭原因必填，至少10个字符
- 操作人必须有关闭权限

---

## 11. 性能优化

### 11.1 列表加载

- 默认加载最近30天的提现记录
- 支持分页加载，每页10-50条可配置
- 使用虚拟滚动优化大数据量展示

### 11.2 数据缓存

- 提现列表数据缓存5分钟
- 提现详情数据缓存3分钟
- 筛选条件保存在本地存储

### 11.3 导出优化

- 大数据量导出使用异步任务
- 导出进度实时显示
- 支持断点续传
