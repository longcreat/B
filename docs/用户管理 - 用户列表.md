# 用户管理 PRD

> 关联文档：[`系统架构图`](./系统架构图.md)、[`用户分类与业务模式逻辑`](./用户分类与业务模式逻辑.md)、[`审核资格`](./审核资格.md)

## 1. 背景与目标
- 在管理员后台统一管理大B/小B账户，支撑 SaaS / MCP / 推广联盟三类业务模式。
- 与资格审核流程衔接：审核通过后写入的字段需要在用户管理模块可查询、可维护。
- 为后续财务中心与风控流程提供基础数据入口（账户状态、风控等级、挂载关系）。

## 2. 范围
- 管理员后台 `users` 模块
  - 商户列表（大B/小B统一列表）
  - 用户详情页
  - 账户状态管理（冻结/激活/关闭）
  - 风控等级管理（L0-L4）
- 财务数据查看、结算操作不在本文范围（参见《财务中心-xxxxx》）。

## 3. 角色与权限
| 角色 | 权限 | 备注 |
| --- | --- | --- |
| Admin（管理员） | 查看/搜索/筛选、进入详情、修改账户状态、调整风控等级 | 仅限平台管理员 |
| BigB / SmallB 客户 | 无访问权限 | 通过各自管理端查看摘要信息 |

## 4. 商户列表（List View）
### 4.1 功能概览
- 展示所有已审核通过的客户（大B + 小B）及其核心字段。
- 支持按照多维度快速检索定位目标客户。

### 4.2 字段对齐
来源：[`系统架构图`](./系统架构图.md#21-商户列表管理)、[`审核资格`](./审核资格.md#71-列表页-adminreviewlist)

| 字段 | 描述 | 取值/示例 | 备注 |
| --- | --- | --- | --- |
| 用户 ID | 系统内部唯一 ID | `USR-000123` | 支撑跨模块跳转 |
| 用户名称 | 商户展示名称 | `杭州慢旅酒店服务中心` | 列表主显字段 |
| 用户信息类型 | 旅行代理 / 网络博主 / 旅游类相关应用 | `旅行代理` | `userType` |
| 认证方式 | 个人认证 / 企业认证 | `企业认证` | `certificationType` |
| 业务模式 | SaaS / MCP / 推广联盟 | `推广联盟` | `businessModel` |
| B 端类型 | 大B / 小B | `小B` | 根据业务模式映射：推广联盟 → 小B，其余 → 大B |
| 挂载大B | 挂载目标大B ID/名称 | `AIGO_BIGB` | 仅小B展示，来源 `parent_partner_id` |
| 风控等级 | L0-L4 | `L3` | 与审核通过配置一致 |
| 邮箱 | 登录邮箱 | `contact@example.com` | |
| 手机号 | 联系手机号 | `138****8000` | |
| 订单数 | 累计订单数 | `256` | 显示订单或 `-` |
| 账户状态 | 正常 / 冻结 / 关闭 | `正常` | `account_status` |
| 最后登录时间 | 最近活跃时间 | `2025-10-21 09:45:00` | 支持为空 |
| 操作 | 查看详情 / 变更账户状态 | — | 操作列按钮 |

### 4.3 搜索与筛选
参考 [`系统架构图`](./系统架构图.md#22-搜索和筛选功能)

| 能力 | 说明 |
| --- | --- |
| 搜索 | 支持名称、邮箱、手机号、用户 ID 模糊搜索；输入后触发 API 调用，列表刷新 |
| 筛选 | 用户信息类型、认证方式、业务模式、账户状态、风控等级；支持多选组合，记忆上次选择；允许一键清空 |
| 分页 | 每页 10 条；保留当前搜索+筛选条件；支持跳页 |

### 4.4 交互要求
- 列表默认按创建时间倒序。
- 小B行需要展示挂载大B的名称/ID，并可点击跳转大B详情。
- 当字段缺失时显示 `-`。
- 列表支持导出当前筛选 CSV（扩展需求，与资格审核保持一致）。

## 5. 用户详情（Detail View）
### 5.1 基本信息区块
与 [`审核资格`](./审核资格.md#85-详情页-adminreviewdetail) 的 D1 保持一致。

| 区块 | 字段 | 说明 |
| --- | --- | --- |
| 基本信息 | 用户 ID、显示名称、用户信息类型、认证方式、业务模式、B端类型、挂载大B、风控等级、账户状态、注册时间、最后登录时间 | 所有字段需支持复制 |
| 联系方式 | 邮箱、手机号 | |
| 店铺信息 | 店铺名称、自定义域名 | 若无则隐藏 |

### 5.2 认证信息卡片
- 根据用户信息类型 × 认证方式动态展示（个人认证卡片 / 企业认证卡片）。
- 字段清单与 [`用户分类与业务模式逻辑`](./用户分类与业务模式逻辑.md#认证表单详细字段) 对齐：
  - 身份信息（真实姓名、证件号、证件有效期、证件图片）
  - 企业主体信息（企业名称、统一社会信用代码、营业执照等）
  - 法人信息 / 联系人信息 / 业务证明材料 / 平台数据截图等
- 资料图片支持点击查看大图、下载；链接字段支持新标签打开。

### 5.3 业务信息卡片
- 业务模式相关字段：
  - SaaS：允许设置加价率（展示当前加价率、可设置标记）
  - MCP：GitHub 账号、作品集链接、应用截图等
  - 推广联盟：推广场景说明、佣金比例、挂载大B信息

### 5.4 操作记录
- 展示风控等级与账户状态的变更记录（操作人、时间、调整前后值、备注）。
- 引用 `review_logs` 与 `user_audit_logs` 数据源。

## 6. 账户状态管理
- 操作入口：列表操作列。
- 状态取值：正常 / 冻结 / 关闭。
- 流程：
  1. 触发弹窗，选择目标状态。
  2. 填写操作原因（必填，≥ 10 字）。
  3. 确认后写入 `account_status`，记录操作日志。
- 影响：冻结/关闭后禁止账号登录；仅在财务中心完成结算冻结解除。

## 7. 风控等级管理
- 操作入口：列表操作列「调整风控等级」。
- 等级枚举：L0（战略级）～ L4（入门级），详见 [`系统架构图`](./系统架构图.md#25-风控等级管理)。
- 流程：
  1. 打开弹窗，选择目标等级。
  2. 填写调整原因（必填，≥ 10 字）。
  3. 确认后写入 `permission_level`，记录日志，并在列表/详情即时生效。

