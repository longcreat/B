# 小B后端管理系统 - UI设计总结文档

## 一、项目概述

### 1.1 项目信息
- **项目名称**: 小B后端管理 (AIGOHOTEL 资质认证管理系统)
- **技术栈**: React 18 + TypeScript + Vite
- **UI框架**: shadcn/ui (基于 Radix UI)
- **样式方案**: Tailwind CSS v4
- **图标库**: Lucide React
- **通知组件**: Sonner (Toast通知)

### 1.2 设计理念
- **现代化**: 采用最新的设计系统和组件库
- **一致性**: 统一的视觉语言和交互模式
- **响应式**: 适配不同屏幕尺寸
- **可访问性**: 基于Radix UI的无障碍支持
- **模块化**: 高度组件化的架构设计

---

## 二、系统架构

### 2.1 整体页面结构

```
App.tsx (主应用)
├── 未登录状态
│   ├── LoginPage (登录页)
│   └── RegisterPage (注册页)
│
├── 管理员视图 (role='admin')
│   └── AdminLayout
│       ├── AdminReviewList (资格审核列表)
│       │   └── 状态筛选: 全部/待审核/已通过/已驳回
│       │   └── 业务模式筛选: MCP/SaaS/推广联盟
│       │   └── 点击查看详情 → AdminReviewDetail
│       │
│       ├── AdminReviewDetail (审核详情页)
│       │   └── 面包屑导航 + 返回按钮
│       │   └── 申请人详细信息展示
│       │   └── 表单数据查看与图片预览
│       │   └── 审核操作: 通过/驳回（含驳回原因输入）
│       │
│       ├── UserManagement (用户管理)
│       │   └── 用户列表、搜索、筛选功能
│       │
│       ├── OrderManagement (订单管理)
│       │   └── 订单列表展示
│       │   └── 状态筛选与搜索功能
│       │   └── 表格横向滚动，固定列（订单号左侧、操作列右侧）
│       │   └── 字段: 订单号、酒店信息、房型、入住信息、小B商户信息、订单状态、结算状态、门控进度、实付金额、退款金额、操作
│       │   └── 点击查看详情 → OrderDetail
│       │
│       ├── OrderDetail (订单详情页)
│       │   └── 面包屑导航: 订单管理 / 订单详情
│       │   └── 页面标题 + 订单状态徽章
│       │   └── Tab导航:
│       │       ├── 状态时间轴 (OrderStatusTimeline)
│       │       │   └── 订单状态变更历史时间线
│       │       │   └── 状态图标 + 描述 + 时间戳
│       │       │
│       │       ├── 基本信息
│       │       │   ├── 订单基本信息 (订单号、创建时间、订单状态等)
│       │       │   ├── 酒店信息 (酒店名称、地址、房型)
│       │       │   ├── 入住信息 (入住日期、离店日期、晚数)
│       │       │   └── 小B商户信息 (商户名称、类型、邮箱)
│       │       │
│       │       ├── 价格与利润
│       │       │   ├── 价格信息 (订单金额、实付金额、退款金额)
│       │       │   ├── 利润分配 (平台利润、小B利润)
│       │       │   └── 价格明细 (供应商成本、平台加价、小B加价)
│       │       │
│       │       └── 门控状态
│       │           ├── 五重门控状态展示
│       │           │   ├── Gate 1: 服务已完成
│       │           │   ├── Gate 2: 冻结期已过
│       │           │   ├── Gate 3: 订单无未决争议
│       │           │   ├── Gate 4: 供应商成本已对账
│       │           │   └── Gate 5: 结算对象状态正常
│       │           └── 门控通过情况汇总 (已通过数量/总数量)
│       │
│       ├── SettlementCenter (结算中心)
│       │   └── 结算订单管理与操作
│       │
│       ├── ApiKeyManagement (API密钥管理)
│       │   └── API密钥的生成、查看、删除功能
│       │
│       └── PriceConfiguration (价格配置)
│           └── 平台加价规则配置
│           └── 价格体系说明（可折叠卡片）
│           └── 规则列表与编辑功能
│
└── 用户视图 (role='user')
    └── UserLayout + ServiceSidebar
        ├── RegistrationSteps (注册服务)
        │   ├── Tab式分步流程:
        │   │   ├── Step 1: BusinessModelSelection (业务模式选择)
        │   │   │   ├── MCP - 大模型与API集成（推荐）
        │   │   │   ├── 品牌预订站 (SaaS方案)
        │   │   │   └── 联盟推广计划
        │   │   │
        │   │   ├── Step 2: 身份类型选择
        │   │   │   ├── 个人认证 (Individual)
        │   │   │   ├── 博主认证 (Influencer)
        │   │   │   └── 企业认证 (Enterprise)
        │   │   │
        │   │   ├── Step 3: 填写认证表单
        │   │   │   ├── IndividualForm (个人表单)
        │   │   │   │   └── 身份证信息、照片上传、联系方式、收款账户
        │   │   │   ├── InfluencerForm (博主表单)
        │   │   │   │   └── 个人身份信息、平台信息、粉丝数据、收款账户
        │   │   │   └── EnterpriseForm (企业表单)
        │   │   │       └── 企业信息、营业执照、法人信息、联系人信息、收款账户
        │   │   │
        │   │   └── Step 4: ReviewStatusPage (审核状态展示)
        │   │       ├── 待审核状态: 显示提交时间与等待提示
        │   │       ├── 已通过状态: 显示审核通过时间与进入后台入口
        │   │       └── 已驳回状态: 显示驳回原因与重新申请入口
        │   │
        │   └── 动态访问控制: 根据审核状态控制Tab访问权限
        │
        ├── UserCenter (个人中心)
        │   └── 个人信息管理
        │   └── 密码修改功能
        │
        └── 业务功能页面 (审核通过后，根据serviceType动态显示)
            │
            ├── MCP服务模块 (serviceType='mcp')
            │   ├── MCPConfiguration (MCP配置)
            │   │   └── API密钥配置与管理
            │   │   └── 服务接入配置
            │   │
            │   ├── MCPMonitoring (用量监控)
            │   │   └── API调用统计与监控
            │   │   └── 用量图表展示
            │   │
            │   └── MCPDocumentation (文档与支持)
            │       └── API文档与使用指南
            │       └── 技术支持入口
            │
            ├── SaaS服务模块 (serviceType='saas')
            │   ├── SaaSDashboard (业务概览)
            │   │   └── 订单统计、收入概览、业务数据图表
            │   │
            │   ├── SaaSBrandConfig (品牌配置)
            │   │   └── 品牌网站配置、Logo上传、品牌定制
            │   │
            │   ├── SaaSPricing (加价策略)
            │   │   └── 价格策略配置、加价规则设置
            │   │
            │   ├── SaaSOrders (订单管理)
            │   │   └── 订单列表、订单详情查看
            │   │
            │   └── SaaSWallet (财务中心)
            │       └── 收入统计、结算记录、提现功能
            │
            └── 推广联盟模块 (serviceType='affiliate')
                ├── AffiliateDashboard (业务概览)
                │   └── 推广数据统计、佣金收入概览
                │
                ├── AffiliateLink (推广物料)
                │   └── 推广链接生成与管理
                │   └── 推广素材下载
                │
                ├── AffiliateData (效果报表)
                │   └── 推广效果数据分析
                │   └── 转化率、点击率等指标展示
                │
                └── AffiliatePoints (积分中心)
                    └── 积分统计与兑换
                    └── 积分规则说明
```

### 2.2 核心设计模式

#### 2.2.1 布局模式
- **管理员布局**: 顶部导航栏 + 左侧折叠式侧边栏
- **用户布局**: 顶部导航栏 + 左侧固定侧边栏 + 主内容区
- **认证页面**: 居中卡片式布局

#### 2.2.2 路由与状态管理
- **基于React状态的页面切换（非路由）**
  - 使用 `useState` 管理当前视图状态
  - 通过 `currentView` 控制页面内容渲染
  - 通过 `selectedOrder` 控制订单详情页显示
  
- **localStorage持久化**
  - 用户状态: `currentUser` (登录状态、角色、服务信息)
  - 申请数据: `applications` (所有申请记录)
  - 用户数据: `users` (注册用户列表)
  
- **动态渲染逻辑**
  - 根据用户角色 (`admin`/`user`) 显示不同布局
  - 根据服务类型 (`mcp`/`saas`/`affiliate`) 显示对应菜单
  - 根据服务状态 (`pending`/`approved`/`rejected`) 控制访问权限
  
- **页面导航流程**
  - **管理员视图**:
    - 订单管理 → 点击订单 → 订单详情页 (OrderDetail)
    - 订单详情页 → 返回按钮 → 订单管理列表
    - 资格审核 → 点击申请 → 审核详情页 (AdminReviewDetail)
    - 审核详情页 → 返回按钮 → 资格审核列表
  
  - **用户视图**:
    - 注册服务 → 审核通过 → 自动跳转到对应服务默认页面
    - 侧边栏菜单 → 点击切换 → 对应业务功能页面
    - 个人中心 → 个人信息管理 → 返回业务页面

---

## 三、核心组件设计

### 3.1 认证系统

#### 3.1.1 登录页面 (LoginPage)
**设计特点**:
- Tab切换: 支持手机号和邮箱两种登录方式
- 响应式布局: 移动端友好的表单设计
- 视觉反馈: 加载状态、错误提示
- 测试账号提示: 内置测试账号说明

**功能模块**:
- 手机号/邮箱登录切换
- 密码显示/隐藏切换
- 登录成功后的状态同步
- 注册页面跳转

#### 3.1.2 注册页面 (RegisterPage)
**设计特点**:
- 统一的注册表单样式
- 表单验证与错误提示
- 用户协议复选框
- 注册成功后的自动登录

### 3.2 业务选择流程

#### 3.2.1 业务模式选择 (BusinessModelSelection)
**三种业务模式**:
1. **MCP - 大模型与API集成** (推荐)
   - 目标用户: 开发者、AI工程师、科技公司
   - 图标: Code
   - 特性: 标准化协议、高性能API

2. **品牌预订站 (SaaS方案)**
   - 目标用户: 旅游博主、KOL、中小型OTA、旅行顾问
   - 图标: Globe
   - 特性: 无需代码、独立网站、品牌定制

3. **联盟推广计划**
   - 目标用户: 内容创作者、社群群主、采购代理
   - 图标: Share2
   - 特性: 推广链接、佣金收入

**设计特点**:
- 卡片式展示，支持悬停效果
- 推荐标签突出显示
- 点击选中状态清晰反馈

#### 3.2.2 身份类型选择
**三种身份类型**:
1. **个人认证** (Individual)
   - 图标: User
   - 适用: 个人开发者和独立创作者

2. **博主认证** (Influencer)
   - 图标: Users
   - 适用: 有一定粉丝基础的内容创作者

3. **企业认证** (Enterprise)
   - 图标: Building2
   - 适用: 企业用户和团队使用

#### 3.2.3 注册表单 (RegistrationSteps)
**分步流程**:
1. **业务选择** - 选择业务模式
2. **身份选择** - 选择身份类型
3. **填写信息** - 根据身份类型显示对应表单
   - IndividualForm (个人表单)
   - InfluencerForm (博主表单)
   - EnterpriseForm (企业表单)
4. **申请状态** - 显示审核状态和结果

**设计特点**:
- Tab式导航，步骤清晰
- 根据审核状态控制Tab访问权限
- 驳回后支持重新申请
- 审核通过后提供进入后台入口

### 3.3 用户布局组件

#### 3.3.1 UserLayout (用户布局)
**顶部导航栏**:
- Logo区域: AIGOHOTEL品牌标识
- 审核状态徽章: 待审核/已通过/已驳回
- 通知中心: 未读通知提示
- 用户菜单: 头像、名称、角色显示

**侧边栏** (ServiceSidebar):
- 动态菜单: 根据服务类型和审核状态显示
- 服务状态提示: 已开通服务的绿色提示卡片

**设计特点**:
- 粘性顶部导航 (sticky header)
- 响应式侧边栏宽度
- 主内容区最大宽度限制，居中显示

#### 3.3.2 动态菜单系统 (menuConfig.ts)
**菜单配置**:
- 通用菜单: 注册服务 (所有用户可见)
- MCP服务菜单: MCP配置、用量监控、文档与支持
- SaaS服务菜单: 业务概览、品牌配置、加价策略、订单管理、财务中心
- 推广联盟菜单: 业务概览、推广物料、效果报表、积分中心

**访问控制**:
- 未审核/审核中: 仅显示"注册服务"
- 审核通过: 显示对应服务类型的菜单
- 审核驳回: 显示"注册服务"，允许重新申请

### 3.4 管理员布局组件

#### 3.4.1 AdminLayout (管理员布局)
**顶部导航**:
- 品牌Logo和"管理后台"标识
- 通知中心
- 用户信息下拉菜单

**左侧边栏**:
- 可折叠设计
- 菜单项:
  - 资格审核 (带待审核数量徽章)
  - 用户管理
  - 订单管理
  - 结算中心
  - 密钥管理
  - 价格配置

**设计特点**:
- 侧边栏可折叠/展开
- 当前菜单项高亮显示
- 待处理数量徽章提示

#### 3.4.2 审核功能模块
**AdminReviewList**:
- 申请列表展示
- 状态筛选: 全部/待审核/已通过/已驳回
- 业务模式筛选: MCP/SaaS/推广联盟
- 状态徽章显示

**AdminReviewDetail**:
- 申请人详细信息展示
- 表单数据查看
- 图片预览功能
- 审核操作: 通过/驳回
- 驳回原因输入

#### 3.4.3 订单管理模块
**OrderManagement (订单管理)**:
- **列表展示**: 表格形式展示订单列表
- **筛选功能**: 
  - 订单状态筛选: 待付款、待确认、已确认、已完成、可结算、已取消、未到店、争议中
  - 搜索功能: 支持订单号、酒店名称等搜索
- **表格特性**:
  - 横向滚动支持: 表格宽度超过容器时可横向滚动
  - 固定列: 订单号列固定在左侧，操作列固定在右侧
  - 响应式设计: 适配不同屏幕尺寸
- **字段展示**:
  - 订单号、酒店信息（酒店名称、房型）、入住信息（入住日期、离店日期、晚数）
  - 小B商户信息（商户名称、商户类型、商户邮箱）
  - 订单状态、结算状态、门控进度（已通过/总门控数）
  - 实付金额、退款金额、操作按钮
- **交互**: 点击"查看详情"按钮跳转到订单详情页

**OrderDetail (订单详情页)**:
- **页面布局**:
  - 面包屑导航: 订单管理 / 订单详情
  - 页面标题: 订单号 + 订单状态徽章
  - 返回按钮: 返回订单管理列表
  
- **Tab导航设计**:
  - Tab栏样式: 无圆角、底部边框、激活状态蓝色下划线
  - Tab间距: Tab栏与表单内容间距 `mb-6`
  - 激活状态: 蓝色文字、加粗字体、底部2px蓝色边框
  - Hover效果: 灰色背景、平滑过渡动画
  
- **Tab内容组织**:
  1. **状态时间轴** (OrderStatusTimeline)
     - 垂直时间线展示订单状态变更历史
     - 每个状态节点: 图标 + 状态描述 + 时间戳
     - 已完成状态显示绿色，进行中显示蓝色，未完成显示灰色
     
  2. **基本信息**
     - 单表单布局，使用分割线分隔不同分类
     - 订单基本信息: 订单号、创建时间、订单状态、结算状态等
     - 酒店信息: 酒店名称、地址、房型
     - 入住信息: 入住日期、离店日期、晚数
     - 小B商户信息: 商户名称、商户类型、商户邮箱
     
  3. **价格与利润**
     - 单表单布局，使用分割线分隔不同分类
     - 价格信息: 订单金额、实付金额、退款金额（突出显示）
     - 利润分配: 平台利润、小B利润
     - 价格明细: 供应商成本、平台加价、小B加价
     
  4. **门控状态**
     - 五重门控状态卡片展示
     - 每个门控卡片: 左侧图标、中间描述、右侧状态按钮
     - 门控通过情况汇总: 已通过数量/总数量、全部通过按钮
     - 视觉设计: 通过状态绿色背景，未通过灰色背景

- **设计特点**:
  - Tab栏与表单无缝连接: 表单顶部无圆角 (`rounded-t-none`)
  - 表单边框: 统一灰色边框，无阴影
  - 分类分隔: 使用 `border-t border-gray-200` 分割线
  - 响应式布局: 适配不同屏幕尺寸

#### 3.4.4 价格配置模块
**PriceConfiguration (价格配置)**:
- **价格体系说明**:
  - 可折叠卡片设计，默认折叠状态
  - 折叠触发器: 左侧图标 + 标题文字 + 右侧折叠图标
  - 折叠动画: 平滑的展开/收起过渡效果
  - 内容说明: P0/P1/P2定价体系、平台加价规则、结算门控等
  
- **加价规则列表**:
  - 表格展示: 规则ID、加价类型、加价规则、适用条件、状态、创建时间
  - 操作按钮: 
    - 编辑按钮: 图标按钮，带Tooltip提示"编辑"
    - 停用/启用按钮: 图标按钮，根据状态显示暂停/播放图标，带Tooltip提示
  - 响应式设计: 表格支持横向滚动
  
- **添加规则功能**:
  - 对话框形式: 点击"添加规则"按钮打开
  - 表单字段: 加价类型、加价规则、适用条件等
  - 表单验证: 必填字段验证与错误提示

- **设计特点**:
  - 图标按钮优化: 使用图标按钮替代文字按钮，节省空间
  - Tooltip提示: 所有图标按钮都有悬停提示
  - 折叠组件: 使用Radix UI Collapsible组件，支持平滑动画
  - 视觉层次: 清晰的卡片分层与间距设计

### A. 依赖包清单
- React 18.3.1
- TypeScript
- Vite 6.3.5
- Tailwind CSS v4
- shadcn/ui组件库
- Radix UI (完整套件)
- Lucide React (图标)
- Sonner (Toast通知)
- Recharts (图表)
- React Hook Form (表单处理)

### B. 项目文件结构
```
src/
├── components/        # 组件目录
│   ├── ui/          # UI基础组件
│   ├── mcp/         # MCP服务组件
│   ├── saas/        # SaaS服务组件
│   └── affiliate/   # 推广联盟组件
├── config/          # 配置文件
├── types/           # TypeScript类型定义
└── styles/          # 样式文件
```

### C. 参考资源
- Figma设计稿: https://www.figma.com/design/kXthmUOwCDmCEV2q8GVQ2m
- shadcn/ui文档: https://ui.shadcn.com/
- Tailwind CSS文档: https://tailwindcss.com/

---

**文档版本**: 1.0  
**最后更新**: 2025年  
**维护者**: UI设计团队

